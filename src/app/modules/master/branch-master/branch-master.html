<div class="section">
    <h2>Branch Master</h2>
    <div class="container-fluid mt-4">
        <div class="card-custom">
            <form [formGroup]="branchForm" (ngSubmit)="onSubmit()">
                <div class="row">
                    <!-- Branch Name -->
                    <div class="col-md-3 mb-3">
                        <label for="branchName" class="form-label">Branch Name</label>
                        <input type="text" id="branchName" class="form-control" formControlName="branchName"
                            [ngClass]="{ 'is-invalid': branchForm.controls['branchName'].invalid && isSubmitted }"
                            placeholder="Enter Branch Name" />
                        <div class="invalid-feedback"
                            *ngIf="branchForm.controls['branchName'].errors?.['required'] && isSubmitted">
                            Branch Name is required.
                        </div>
                    </div>

                    <!-- Branch Code -->
                    <div class="col-md-3 mb-3">
                        <label for="branchCode" class="form-label">Branch Code</label>
                        <input type="text" id="branchCode" class="form-control" formControlName="branchCode"
                            [ngClass]="{ 'is-invalid': branchForm.controls['branchCode'].invalid && isSubmitted }"
                            placeholder="Enter Branch Code" />
                        <div class="invalid-feedback"
                            *ngIf="branchForm.controls['branchCode'].errors?.['required'] && isSubmitted">
                            Branch Code is required.
                        </div>
                    </div>

                    <!-- State -->
                    <div class="col-md-3 mb-3">
                        <label for="state" class="form-label">State</label>

                        <ng-select [items]="states" bindLabel="label" bindValue="value" placeholder="Select State"
                            formControlName="state" class="ng-select"
                            [ngClass]="{ 'is-invalid': branchForm.controls['state'].invalid && isSubmitted }">
                        </ng-select>


                        <div class="invalid-feedback"
                            *ngIf="branchForm.controls['state'].errors?.['required'] && isSubmitted">
                            State is required.
                        </div>
                    </div>


                    <!-- Email -->
                    <div class="col-md-3 mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" id="email" class="form-control" formControlName="email"
                            [ngClass]="{ 'is-invalid': branchForm.controls['email'].invalid && isSubmitted }"
                            placeholder="Enter Email" />
                        <div class="invalid-feedback"
                            *ngIf="branchForm.controls['email'].errors?.['required'] && isSubmitted">
                            Email is required.
                        </div>
                        <div class="invalid-feedback"
                            *ngIf="branchForm.controls['email'].errors?.['email'] && isSubmitted">
                            Enter a valid email.
                        </div>
                    </div>

                    <!-- Phone -->
                    <div class="col-md-3 mb-3">
                        <label for="phone" class="form-label">Phone</label>
                        <input type="text" id="phone" class="form-control" formControlName="phone"
                            [ngClass]="{ 'is-invalid': branchForm.controls['phone'].invalid && isSubmitted }"
                            placeholder="Enter Phone Number" />
                        <div class="invalid-feedback"
                            *ngIf="branchForm.controls['phone'].errors?.['required'] && isSubmitted">
                            Phone is required.
                        </div>
                        <div class="invalid-feedback"
                            *ngIf="branchForm.controls['phone'].errors?.['pattern'] && isSubmitted">
                            Enter a valid phone number.
                        </div>
                    </div>
                </div>

                <!-- Details & Buttons -->
                <div class="mt-4">
                    <div class="card-title">Branch Details</div>
                    <div class="card-text">Fill in the form below with accurate branch information.</div>

                    <div class="card-action d-flex justify-content-center align-items-center gap-2 mt-3">
                        <button class="btn btn-primary" type="button" (click)="toggleViewList()">
                            {{ showViewList ? 'Hide List' : 'View List' }}
                        </button>


                        <button class="btn btn-success" type="submit">Submit</button>
                        <button mat-flat-button color="warn" type="button" (click)="onCancel()">Reset</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <!-- Grid View Below the Form -->
    @if(showViewList){ <div class="mt-4 card-custom">

        <app-grid-view [title]="'Branch List'" [columns]="branchColumns" [data]="branchData"
            (edit)="onEditBranch($event)" (delete)="onDeleteBranch($event)">
        </app-grid-view>

    </div>
    }
</div>
<ngx-spinner bdColor="rgba(0,0,0,0.8)" size="medium" color="#fff" type="square-jelly-box" [fullScreen]="true">
</ngx-spinner>